<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=1024">
  <title>Breacher Reminder Log</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #0a0a0a;
      color: #e0f8ff;
      line-height: 1.6;
      padding: 2rem;
    }
    .container {
      max-width: 1024px;
      margin: auto;
      border: 1px solid #244b5a;
      padding: 2rem;
      border-radius: 12px;
      background: rgba(10, 30, 40, 0.95);
      box-shadow: 0 0 12px #00b4ff33;
    }
    .title {
      font-size: 2.35rem;
      font-weight: bold;
      letter-spacing: 1.4px;
      color: #00b4ff;
      text-shadow: 0 0 8px #00b4ff44, 0 2px 8px #000d;
      margin-bottom: 1em;
      text-align: center;
    }
    .section {
      margin-bottom: 2em;
    }
    .section-title {
      font-size: 1.5rem;
      color: #8defff;
      margin-bottom: 0.6em;
    }
    .checklist-item {
      position: relative;
      display: flex;
      align-items: center;
      justify-content: flex-start;
      transition: background 0.18s, color 0.2s;
      padding-left: 2em;
      cursor: pointer;
      border-radius: 0.4em;
      min-height: 2.4em;
    }
    .checklist-item::before {
      content: "⬜";
      position: absolute;
      left: 0;
      font-size: 1.25em;
      color: #aaa;
      transition: color 0.2s;
      cursor: pointer;
    }
    .checklist-item.checked::before {
      content: "✅";
      color: #8fff94;
    }
    .checklist-item.checked {
      color: #b8ffcc;
    }
    .checklist-item:hover, .checklist-item:focus-within {
      background: #00335655;
    }
    .checklist-item:hover .checklist-left,
    .checklist-item:hover .checklist-divider,
    .checklist-item:hover .checklist-right,
    .checklist-item:focus-within .checklist-left,
    .checklist-item:focus-within .checklist-divider,
    .checklist-item:focus-within .checklist-right {
      color: #69d2ff;
    }
    .checklist-content {
      display: flex;
      justify-content: flex-start;
      gap: 1em;
      margin-left: 0;
      flex: 1;
      user-select: none;
    }
    .checklist-left, .checklist-right {
      white-space: nowrap;
      transition: color 0.2s;
    }
    .checklist-left {
      text-align: right;
      flex: 2;
    }
    .checklist-divider {
      flex: 0;
      color: #888;
      min-width: 2em;
      text-align: center;
      transition: color 0.2s;
    }
    .checklist-right {
      text-align: left;
      flex: 5;
    }
    .delete-btn {
      opacity: 0;
      pointer-events: none;
      background: none;
      border: none;
      color: #ff8888;
      font-size: 1.2em;
      margin-left: 0.5em;
      cursor: pointer;
      transition: opacity 0.2s, color 0.2s;
      width: 2em; /* ensure consistent width */
      height: 2em;
      vertical-align: middle;
    }
    .checklist-item:hover .delete-btn,
    .checklist-item:focus-within .delete-btn {
      opacity: 1;
      pointer-events: auto;
    }

    .add-btn {
      display: block;
      margin: 1em auto 0;
      padding: 0.5em 1.2em;
      font-size: 1rem;
      background-color: #00b4ff;
      color: #000;
      border: none;
      border-radius: 0.5em;
      cursor: pointer;
      transition: background-color 0.3s;
    }
    .add-btn:hover {
      background-color: #0096cc;
    }
  </style>
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js';
    import { getDatabase, ref, push, onValue, update, remove } from 'https://www.gstatic.com/firebasejs/10.12.0/firebase-database.js';

    const firebaseConfig = {
      apiKey: "AIzaSyAaJ_Xt0l7O4He6YWrx2XWg_xvsPMThnxM",
      authDomain: "breacher-commands.firebaseapp.com",
      databaseURL: "https://breacher-commands-default-rtdb.firebaseio.com",
      projectId: "breacher-commands",
      storageBucket: "breacher-commands.appspot.com",
      messagingSenderId: "521787055932",
      appId: "1:521787055932:web:2c61dee47bd56ed6be4839"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const listRef = ref(db, "reminders");

    onValue(listRef, (snapshot) => {
      const log = document.getElementById("log-section");
      log.innerHTML = '<div class="section-title">Command List</div>';
      snapshot.forEach(child => {
        const key = child.key;
        const data = child.val();
        const div = document.createElement('div');
        div.className = 'checklist-item';
        if (data.checked) div.classList.add('checked');

        // Checkmark click area
        div.addEventListener('click', (e) => {
          // If it's the delete button, don't toggle!
          if (e.target.classList.contains('delete-btn')) return;
          const checked = !div.classList.contains('checked');
          div.classList.toggle('checked');
          update(ref(db, `reminders/${key}`), { checked });
        });

        const parts = data.text.split("-");
        const left = parts[0]?.trim() ?? "";
        const right = parts[1]?.trim() ?? "";

        const content = document.createElement('div');
        content.className = 'checklist-content';
        content.innerHTML = `
          <span class="checklist-left">${left}</span>
          <span class="checklist-divider">-</span>
          <span class="checklist-right">${right}</span>
        `;

        // Delete button (only deletes, does not toggle)
        const delBtn = document.createElement('button');
        delBtn.className = 'delete-btn';
        delBtn.textContent = '❌';
        delBtn.title = 'Delete this item';
        delBtn.tabIndex = 0;
        delBtn.onclick = (e) => {
          e.stopPropagation();
          if (confirm("Remove this item?")) {
            remove(ref(db, `reminders/${key}`));
          }
        };

        div.appendChild(content);
        div.appendChild(delBtn);
        log.appendChild(div);
      });
    });

    window.addReminder = async function () {
      const text = prompt("Enter your new reminder:");
      if (text) {
        push(listRef, { text, checked: false });
      }
    };
  </script>
</head>
<body>
  <div class="container">
    <div class="title">Breacher Commands</div>
    <div class="section" id="log-section">
      <div class="section-title">Command List</div>
    </div>
    <button class="add-btn" onclick="addReminder()">+ Add New Command</button>
  </div>
</body>
</html>
